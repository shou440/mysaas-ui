(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-74aa"],{"1kY7":function(t,e,i){t.exports=i.p+"static/img/money1.bacbe3e.png"},"7NCs":function(t,e,i){"use strict";var s=i("FSOU");i.n(s).a},ANdJ:function(t,e,i){"use strict";var s=i("dqsd");i.n(s).a},FSOU:function(t,e,i){},HrOp:function(t,e,i){t.exports=i.p+"static/img/arrowleft.f559609.png"},Qql6:function(t,e,i){"use strict";i.r(e);var s=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"infoitem-img"},[e("img",{staticStyle:{height:"16px",width:"16px"},attrs:{src:i("x7yp")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"infoitem-img"},[e("img",{staticStyle:{height:"16px",width:"16px"},attrs:{src:i("XUji")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"infoitem-img"},[e("img",{staticStyle:{height:"16px",width:"16px"},attrs:{src:i("bOJu")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"infoitem-img"},[e("img",{staticStyle:{height:"16px",width:"16px"},attrs:{src:i("ZGmL")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"infoitem"},[e("div",{staticClass:"infoitem-img"},[e("img",{staticStyle:{height:"16px",width:"16px"},attrs:{src:i("1kY7")}})]),this._v(" "),e("div",{staticClass:"infoitem-text"},[this._v("\n                    充值记录\n                ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"infoitem-img"},[e("img",{staticStyle:{height:"16px",width:"16px"},attrs:{src:i("ga+D")}})])}],n=i("Asgo"),r=i.n(n),a=i("W1CG"),o={name:"meternumber",props:{totalwidth:String,totalheight:String,bits:Number,floatbits:Number,bgcolor:String,numbgcolor:String,value:Number,bitwidth:Number,bitHeight:Number},data:function(){return{numberbits:[],numbervalue:this.value,hasInited:!1}},mounted:function(){this.formatvalue(),this.freshui(),this.hasInited=!0},watch:{value:function(t){this.numbervalue=t,this.hasInited&&(this.formatvalue(),this.freshui())}},methods:{formatvalue:function(){var t=0,e=0,i=1,s=parseInt(10*this.numbervalue);for(this.numberbits=[],t=0;t<this.bits;t++)0==t?e=s%10:(i*=10,(e=parseInt(s/i))<1?e=0:e%=10),this.numberbits.push({bitindex:t,bitvalue:e,order:t+1})},freshui:function(){var t=this,e=this;this.$nextTick(function(){var i=t.$refs.bitElemList.length;t.$refs.bitElemList.forEach(function(t,s){t.style.width="16px",t.style.height="24px",t.style.color="white",t.innerHTML=e.numberbits[i-s-1].bitvalue+"",s+=1,t.style.background=s==i?"red":"black",t.style.borderRadius=1==s?"6px 6px 6px 6px":"0px 0px 0px 0px"})})}}},c=(i("XYwL"),i("ZrdR")),h=Object(c.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"powerbitpannel",style:{width:t.totalwidth,height:t.totalheight,background:t.bgcolor}},t._l(t.numberbits,function(e){return i("div",{key:e.bitindex,ref:"bitElemList",refInFor:!0,staticClass:"powerbit",style:{order:e.order}},[i("div",[t._v(t._s(e.order))])])}))},[],!1,null,null,null);h.options.__file="meternumber.vue";var d=h.exports,l={name:"myinfo",props:{frcolor:String,bgcolor:String,fontsize:String,title:String,content:String},mounted:function(){this.$refs.contentdiv.style.color=this.frcolor,this.$refs.infodiv.style.color=this.frcolor},methods:{loadsize:function(){}}},u=(i("W6AP"),Object(c.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"infopannel"},[i("div",{ref:"contentdiv",staticClass:"infocontent"},[t._v(t._s(t.content))]),t._v(" "),i("div",{staticClass:"myinfogap"}),t._v(" "),i("div",{ref:"infodiv",staticClass:"myinfotitle"},[t._v(t._s(t.title))])])},[],!1,null,null,null));u.options.__file="myinfo.vue";var m=u.exports,v={name:"myinfobutton",props:{img:String,frcolor:String,bgcolor:String,fontsize:String,title:String,content:String,imgheight:String,imgwidth:String},data:function(){return{imgsrc:this.img,infotitle:this.title,imgheight1:this.imgheight,imgwidth1:this.imgwidth}},mounted:function(){var t=this;this.$nextTick(function(){null!=t.$refs.img&&(t.$refs.img.style.width=t.imgwidth1,t.$refs.img.style.height=t.imgheight1)})},methods:{}},p=(i("7NCs"),Object(c.a)(v,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"infopannel"},[e("div",{staticClass:"infoimg"},[e("img",{ref:"img",attrs:{id:"img1",src:this.imgsrc}})]),this._v(" "),e("div",{staticClass:"infotitle"},[this._v(this._s(this.infotitle))])])},[],!1,null,null,null));p.options.__file="myinfobutton.vue";var f={name:"premetercharge",components:{meternumber:d,myinfo:m,myinfobutton:p.exports},data:function(){return{bodysize:{width:"200px",height:"",background:"white"},imgsize:{width:"200px",height:""},isbusy:!1,openid:"",nikename:"",headimg:"",currentmeter:this.$store.state.premeter.currentpremeter,chargevalue:1,state:2,meterid:0,meterleftEP:0,metertotalEP:0,meterPt:0,meterName:"",currentmonthEP:"",todayEP:"",lastMonthEP:"",code:0,starttick:0,expiretick:0,accessorydata:0,showop:!1,show:!1,value:"123",showKeyboard:!0,yksel:0}},created:function(){this.loadsize()},watch:{nikename:function(t,e){}},methods:{testPay:function(){var t=this,e={openid:"oRvGF1YWJSGup8qiY27js5BbOf70",paymentid:getBeijingtimeStam()+"11",message:"testpay",fFee:1};new r.a(function(){crtunifiledorder(e).then(function(e){t.orderinfo=e.data.data,t.orderinfo}).catch(function(t){})})},callPay:function(){"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",onBridgeReady,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",onBridgeReady),document.attachEvent("onWeixinJSBridgeReady",onBridgeReady)):this.onBridgeReady()},onBridgeReady:function(){var t=this;getBeijingtimeStam(),t.orderinfo.packages;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.orderinfo.appId,timeStamp:t.orderinfo.timeStamp,nonceStr:t.orderinfo.nonceStr,package:t.orderinfo.package,signType:"MD5",paySign:t.orderinfo.paySign},function(e){""!=e.errMsg&&(t.wxparam.ret=2,t.errmsg=e.errMsg)})},backparent:function(){router.replace({path:"/main/dev"})},onHistory:function(){router.replace({path:"/main/historydata"})},onselopeclick:function(){this.showop=!0},onclickHezha:function(){this.show=!0,this.showop=!1,this.value="",this.yksel=0},onclickFenzha:function(){this.show=!0,this.showop=!1,this.value="",this.yksel=1},onInput:function(t){this.value=(this.value+t).slice(0,6),6==this.value.length&&("123456"==this.value?this.ykoperation():(alert("密码错误"),this.value=""))},showOperationTip:function(){var t=this,e=(a.a.loading({duration:0,forbidClick:!0,message:"命令执行中...",loadingType:"spinner",selector:"#custom-tip"}),30),i=setInterval(function(){--e&&3==t.state||(clearInterval(i),a.a.clear())},1e3)},onDelete:function(){this.value=this.value.slice(0,this.value.length-1)},toFixFormat:function(t){return(parseFloat(t)/100).toFixed(1)},loadsize:function(){this.bodysize.height=window.innerHeight+"px",this.bodysize.width=window.width+"px"},stateLoadMeter:function(){if(!this.isbusy){this.isbusy=!0;var t=this;axios({url:this.$GetServerURL()+"/Meter/GetMeter",method:"post",responseType:"json",data:{MeterID:t.meterid}}).then(function(e){null!=e.data&&(t.currentmeter=e.data),t.isbusy=!1,t.state=2}).catch(function(t){})}},stateFetchCmdState:function(){if(!this.isbusy){this.isbusy=!0;var t=this,e=parseInt(this.starttick)+"",i=parseInt(this.expiretick)+"",s=this.code+"";axios({url:this.$GetServerURL()+"/Meter/FetchCmdState",method:"post",responseType:"json",data:{openid:t.openid,meterid:meterIDStr,code:s,starttick:e,expiretick:i,pwd:"1000",fee:"1000"}}).then(function(e){return null==e.data||e.data.IsError?t.$GetCurrentSec()>t.expiretick?(a.a.fail("超时未响应"),t.isbusy=!1,void(t.state=2)):(t.isbusy=!1,void(t.state=3)):4==e.data.Data.state&&e.data.Data.starttick==t.starttick?(a.a.success("命令执行成功"),t.isbusy=!1,void(t.state=2)):t.$GetCurrentSec()>t.expiretick?(a.a.fail("超时未响应"),t.isbusy=!1,void(t.state=2)):(t.isbusy=!1,void(t.state=3))}).catch(function(e){alert("执行失败"),t.isbusy=!1,t.state=2})}},CallTick:function(){switch(null!=this.currentmeter&&(this.meterleftEP=this.currentmeter.LeftEP/100,this.metertotalEP=this.currentmeter.TotalEP/100,this.meterPt=(this.currentmeter.Pt/1e4).toFixed(3),this.meterName=this.currentmeter.Addr+"_"+this.currentmeter.Name,this.currentmonthEP=this.currentmeter.CurrentMonthEP/100+"",this.todayEP=this.currentmeter.TodayEP/100+"",this.lastMonthEP=this.currentmeter.LastMonthEP/100+"",this.meterid=this.currentmeter.ID),this.state){case 0:this.state=1;break;case 1:this.stateLoadMeter();break;case 2:break;case 3:this.stateFetchCmdState()}},CommitCmd:function(t){if(!this.isbusy){this.isbusy=!0,this.starttick=this.$GetCurrentSec(),this.expiretick=this.starttick+30,this.code=t;var e=parseInt(this.starttick)+"",i=parseInt(this.expiretick)+"",s=this.code+"",n=this;this.showOperationTip(),axios({url:this.$GetServerURL()+"/Meter/MeterCmd",method:"post",responseType:"json",data:{openid:n.openid,meterid:meterIDStr,code:s,starttick:e,expiretick:i,pwd:"1000",data:"1000"}}).then(function(t){n.state=3,n.show=!1,n.isbusy=!1}).catch(function(t){})}},chargemeter:function(){},ykoperation:function(){0==this.yksel?this.code=51:this.code=50,this.CommitCmd(this.code)}},mounted:function(){this.$nextTick(function(){})}},g=(i("ANdJ"),Object(c.a)(f,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"devpage-body",style:t.bodysize},[s("van-toast",{attrs:{id:"custom-tip"}}),t._v(" "),s("van-popup",{attrs:{position:"bottom",overlay:!0,"custom-style":"height: 80%;"},model:{value:t.showop,callback:function(e){t.showop=e},expression:"showop"}},[s("div",{staticClass:"devpage-operation"},[s("div",{staticClass:"devpage-operation-on",on:{click:function(e){t.onclickHezha()}}},[t._v("\n                合闸\n            ")]),t._v(" "),s("div",{staticClass:"devpage-operation-off",on:{click:function(e){t.onclickFenzha()}}},[t._v("\n                分闸\n            ")])])]),t._v(" "),s("van-popup",{attrs:{position:"bottom",overlay:!0},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"pay_password"},[s("div",{staticClass:"password_input"},[s("p",{staticStyle:{"text-align":"center"}},[t._v("请输入操作密码")]),t._v(" "),s("van-password-input",{attrs:{value:t.value}})],1),t._v(" "),s("van-number-keyboard",{attrs:{show:t.show},on:{blur:function(e){t.show=!1},input:t.onInput,delete:t.onDelete}})],1)]),t._v(" "),s("div",{attrs:{id:"devpage-row1"}},[s("div",{staticClass:"devitem-magrin-gap"}),t._v(" "),s("div",{staticClass:"row1-body"},[s("div",{attrs:{id:"sel-meter"}},[s("div",{attrs:{id:"sel-meter-selarrow"},on:{click:function(e){t.backparent()}}},[s("img",{staticStyle:{height:"16px",width:"16px"},attrs:{src:i("HrOp")}}),t._v("\n                      返回\n                  ")]),t._v(" "),s("div",{attrs:{id:"sel-meter-meter"}},[t._v("\n                      "+t._s(this.currentmeter.meter_addr)+"_"+t._s(this.currentmeter.room_name)+"\n                  ")])]),t._v(" "),s("div",{attrs:{id:"devpage-title"}},[t._v("\n                电表余额(kwh)\n             ")]),t._v(" "),s("div",{attrs:{id:"devpage-leftEP"}},[s("meternumber",{attrs:{totalwidth:"100%",totalheight:"60px",bgcolor:"#0084FF",bits:7,value:t.meterleftEP}})],1),t._v(" "),s("div",{attrs:{id:"devpage-foot"}},[s("myinfo",{attrs:{title:"",content:""}}),t._v(" "),s("myinfo",{attrs:{title:"电价(kwh)",frcolor:"#FFFFFF",content:t.currentmonthEP}}),t._v(" "),s("myinfo",{attrs:{title:"上月(kwh)",frcolor:"#FFFFFF",content:t.lastMonthEP}}),t._v(" "),s("myinfo",{attrs:{title:"今日(kwh)",frcolor:"#FFFFFF",content:t.todayEP}}),t._v(" "),s("myinfo",{attrs:{title:"",content:""}})],1)]),t._v(" "),s("div",{staticClass:"devitem-magrin-gap"})]),t._v(" "),s("div",{attrs:{id:"devpage-row2"}},[s("div",{staticClass:"infoitem"},[t._m(0),t._v(" "),s("div",{staticClass:"infoitem-text"},[t._v("\n                    "+t._s(this.metertotalEP)+"kwh\n                ")])]),t._v(" "),s("div",{staticClass:"infoitem"},[t._m(1),t._v(" "),s("div",{staticClass:"infoitem-text"},[t._v("\n                    "+t._s(this.meterPt)+"kw\n                ")])]),t._v(" "),s("div",{staticClass:"infoitem",on:{click:function(e){t.onselopeclick()}}},[t._m(2),t._v(" "),s("div",{staticClass:"infoitem-text"},[t._v("\n                    合闸\n                ")])])]),t._v(" "),s("div",{attrs:{id:"devpage-row2"}},[s("div",{staticClass:"infoitem",on:{click:function(e){t.CommitCmd(49)}}},[t._m(3),t._v(" "),s("div",{staticClass:"infoitem-text"},[t._v("\n                    刷新\n                ")])]),t._v(" "),t._m(4),t._v(" "),s("div",{staticClass:"infoitem",on:{click:function(e){t.onHistory()}}},[t._m(5),t._v(" "),s("div",{staticClass:"infoitem-text"},[t._v("\n                    用电记录\n                ")])])]),t._v(" "),s("div",{attrs:{id:"devpage-row3"}},[s("div",{staticClass:"devpage-gap"}),t._v(" "),s("div",{staticClass:"devpage-button"},[s("van-button",{attrs:{type:"info",size:"large"},on:{click:function(e){t.chargemeter()}}},[t._v("电费充值")])],1),t._v(" "),s("div",{staticClass:"devpage-gap"})])],1)},s,!1,null,null,null));g.options.__file="premetercharge.vue";e.default=g.exports},W6AP:function(t,e,i){"use strict";var s=i("xcHm");i.n(s).a},XUji:function(t,e,i){t.exports=i.p+"static/img/power.75dc290.png"},XYwL:function(t,e,i){"use strict";var s=i("vVqz");i.n(s).a},ZGmL:function(t,e,i){t.exports=i.p+"static/img/timer.ab7147c.png"},bOJu:function(t,e,i){t.exports=i.p+"static/img/statushe.62fe24d.png"},dqsd:function(t,e,i){},"ga+D":function(t,e,i){t.exports=i.p+"static/img/current.590d724.png"},vVqz:function(t,e,i){},x7yp:function(t,e,i){t.exports=i.p+"static/img/totalep.c2512ed.png"},xcHm:function(t,e,i){}}]);